<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ“… å°ç£ç‰¹ä¼‘è¨ˆç®—æ©Ÿ | Taiwan Annual Leave Calculator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans TC', sans-serif; }
    </style>
</head>
<body class="bg-gray-50 min-h-screen flex flex-col items-center py-10 px-4">

    <!-- Header -->
    <header class="w-full max-w-md flex justify-between items-center mb-8">
        <a href="../../index.html" class="text-blue-600 hover:text-blue-800 font-medium flex items-center transition-colors">
            <span class="mr-1">ğŸ </span> å›é¦–é 
        </a>
        <h1 class="text-xl font-bold text-gray-800">ç‰¹ä¼‘å‡è©¦ç®—</h1>
    </header>

    <!-- Main Card -->
    <main class="w-full max-w-md bg-white rounded-2xl shadow-xl p-6 sm:p-8">
        <h2 class="text-2xl font-bold text-center text-gray-900 mb-2">ä½ çš„ç‰¹ä¼‘æœ‰å¤šå°‘ï¼Ÿ</h2>
        <p class="text-center text-gray-500 text-sm mb-6">ä¾æ“šå‹å‹•åŸºæº–æ³•ç¬¬38æ¢è¦å®šè¨ˆç®—</p>

        <!-- Input Section -->
        <div class="space-y-5">
            <div>
                <label for="startDate" class="block text-sm font-medium text-gray-700 mb-1">å…¥è·æ—¥æœŸ (Start Date)</label>
                <input type="date" id="startDate" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all" required>
            </div>
            
            <div>
                <label for="calcDate" class="block text-sm font-medium text-gray-700 mb-1">è¨ˆç®—åŸºæº–æ—¥ (Calculation Date)</label>
                <input type="date" id="calcDate" class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none transition-all">
                <p class="text-xs text-gray-400 mt-1">é è¨­ç‚ºä»Šæ—¥</p>
            </div>

            <button onclick="calculateLeave()" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 rounded-lg shadow-md transition-transform transform active:scale-95">
                é–‹å§‹è¨ˆç®— ğŸš€
            </button>
        </div>

        <!-- Result Section (Hidden initially) -->
        <div id="result" class="hidden mt-8 pt-6 border-t border-gray-100 animate-fade-in">
            <div class="bg-blue-50 rounded-xl p-5 text-center mb-4">
                <p class="text-sm text-blue-600 mb-1">ç›®å‰å¹´è³‡</p>
                <h3 id="tenureText" class="text-xl font-bold text-blue-900">--</h3>
            </div>

            <div class="bg-green-50 rounded-xl p-5 text-center mb-4">
                <p class="text-sm text-green-600 mb-1">ä¾æ³•æ‡‰çµ¦ç‰¹ä¼‘å¤©æ•¸</p>
                <div class="flex justify-center items-end">
                    <span id="leaveDays" class="text-5xl font-extrabold text-green-600 leading-none">0</span>
                    <span class="text-lg font-medium text-green-700 ml-1 mb-1">å¤©</span>
                </div>
            </div>

            <div class="text-sm text-gray-600 space-y-2 bg-gray-50 p-4 rounded-lg">
                <div class="flex justify-between">
                    <span>ä¸‹ä¸€éšæ®µç‰¹ä¼‘å¤©æ•¸ï¼š</span>
                    <span id="nextLeaveDays" class="font-bold">--</span>
                </div>
                <div class="flex justify-between">
                    <span>é è¨ˆç”Ÿæ•ˆæ—¥æœŸï¼š</span>
                    <span id="nextEffectiveDate" class="font-bold text-gray-800">--</span>
                </div>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="mt-12 text-center text-gray-400 text-xs">
        <p>Created by AI Agent on <span id="currentDate"></span></p>
        <p class="mt-1">æ­¤è¨ˆç®—çµæœåƒ…ä¾›åƒè€ƒï¼Œå¯¦éš›ç‰¹ä¼‘ä»¥å…¬å¸è¦å®šç‚ºæº–</p>
    </footer>

    <script>
        // Set default dates
        const today = new Date().toISOString().split('T')[0];
        document.getElementById('calcDate').value = today;
        document.getElementById('currentDate').textContent = new Date().toLocaleDateString();

        function calculateLeave() {
            const startDateStr = document.getElementById('startDate').value;
            const calcDateStr = document.getElementById('calcDate').value;

            if (!startDateStr) {
                alert('è«‹è¼¸å…¥å…¥è·æ—¥æœŸï¼');
                return;
            }

            const start = new Date(startDateStr);
            const calc = new Date(calcDateStr);

            if (calc < start) {
                alert('è¨ˆç®—åŸºæº–æ—¥ä¸èƒ½æ—©æ–¼å…¥è·æ—¥æœŸï¼');
                return;
            }

            // Calculate tenure in years and months
            let years = calc.getFullYear() - start.getFullYear();
            let months = calc.getMonth() - start.getMonth();
            let days = calc.getDate() - start.getDate();

            if (days < 0) {
                months--;
            }
            if (months < 0) {
                years--;
                months += 12;
            }

            // Display tenure
            const tenureText = `${years} å¹´ ${months} å€‹æœˆ`;
            document.getElementById('tenureText').textContent = tenureText;

            // Determine leave days based on Labor Standards Act Article 38
            // 6m-1y: 3
            // 1y-2y: 7
            // 2y-3y: 10
            // 3y-5y: 14
            // 5y-10y: 15
            // 10y+: 15 + (y-10), max 30

            let currentDays = 0;
            let nextDays = 0;
            let nextMilestoneDate = new Date(start); // Start from hiring date

            // Determine current entitlement
            if (years === 0 && months >= 6) {
                currentDays = 3;
                nextDays = 7;
                nextMilestoneDate.setFullYear(start.getFullYear() + 1);
            } else if (years === 0 && months < 6) {
                currentDays = 0;
                nextDays = 3;
                nextMilestoneDate.setMonth(start.getMonth() + 6);
            } else if (years >= 1 && years < 2) {
                currentDays = 7;
                nextDays = 10;
                nextMilestoneDate.setFullYear(start.getFullYear() + 2);
            } else if (years >= 2 && years < 3) {
                currentDays = 10;
                nextDays = 14;
                nextMilestoneDate.setFullYear(start.getFullYear() + 3);
            } else if (years >= 3 && years < 5) {
                currentDays = 14;
                if (years === 3) {
                    // Next bump is still 14 until year 5? No, year 4 is also 14.
                    // Actually, the law says: "3 years but less than 5 years: 14 days".
                    // So at year 4, it is still 14.
                    // The "next milestone" for *increase* is year 5.
                    nextDays = 15;
                    nextMilestoneDate.setFullYear(start.getFullYear() + 5);
                } else { // years === 4
                    nextDays = 15;
                    nextMilestoneDate.setFullYear(start.getFullYear() + 5);
                }
            } else if (years >= 5 && years < 10) {
                currentDays = 15;
                nextDays = 16; // At 10 years, it becomes 16 (15 + (10-10) is wrong? No, 10 years is 15+1=16?)
                // Law: "10 years or more: 1 additional day for each year of service over 10 years, up to a maximum of 30 days."
                // So at 10 years completed: 15 + (10-10) = 15? No.
                // Text: "ten years or more: fifteen days, plus one additional day for each year of service over ten years."
                // "Over ten years" usually means (years - 10).
                // Let's check common interpretation.
                // 5-9 years: 15 days.
                // 10 years: 16 days. (15 + 1)
                // 11 years: 17 days.
                nextMilestoneDate.setFullYear(start.getFullYear() + 10);
            } else if (years >= 10) {
                // Formula: 15 + (years - 9)?
                // 10 yr -> 16
                // 11 yr -> 17
                // ...
                // 24 yr -> 30
                // 25 yr -> 30
                currentDays = 15 + (years - 9); 
                if (currentDays > 30) currentDays = 30;

                nextDays = currentDays + 1;
                if (nextDays > 30) nextDays = 30;
                
                nextMilestoneDate.setFullYear(start.getFullYear() + years + 1);
            }

            // Logic fix for the "next milestone" date display
            // If already at max (30 days), next milestone doesn't increase days, just next year.
            
            document.getElementById('leaveDays').textContent = currentDays;
            document.getElementById('nextLeaveDays').textContent = nextDays + " å¤©";
            
            // Format next date
            const nextDateString = nextMilestoneDate.toLocaleDateString('zh-TW', { year: 'numeric', month: 'long', day: 'numeric' });
            document.getElementById('nextEffectiveDate').textContent = nextDateString;

            // Show results
            document.getElementById('result').classList.remove('hidden');
        }
    </script>
</body>
</html>
