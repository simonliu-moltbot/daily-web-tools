<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è‡ªåŠ©é¤é˜¿å§¨å¿ƒç®—è¡“ | Buffet Price Predictor</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans TC', sans-serif; }
        .dish-btn { transition: all 0.2s; }
        .dish-btn:active { transform: scale(0.95); }
    </style>
</head>
<body class="bg-yellow-50 min-h-screen text-gray-800 flex flex-col">

    <!-- Navbar -->
    <nav class="bg-orange-600 text-white p-4 shadow-lg sticky top-0 z-50">
        <div class="max-w-2xl mx-auto flex justify-between items-center">
            <a href="../../index.html" class="flex items-center gap-2 hover:text-orange-200 transition">
                <span>ğŸ </span> <span class="hidden sm:inline">å›é¦–é </span>
            </a>
            <h1 class="text-xl font-bold tracking-wider">è‡ªåŠ©é¤é˜¿å§¨å¿ƒç®—è¡“ ğŸ±</h1>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="flex-grow container max-w-2xl mx-auto p-4 space-y-6">
        
        <!-- Intro Card -->
        <div class="bg-white p-6 rounded-2xl shadow-sm border border-orange-100">
            <p class="text-gray-600 mb-2">ã€Œé˜¿å§¨ï¼Œé€™ç›¤å¤šå°‘ï¼Ÿã€</p>
            <p class="text-sm text-gray-500">è¼¸å…¥ä½ çš„èœè‰²èˆ‡è®Šæ•¸ï¼Œæ¨¡æ“¬å‡ºæœ€çœŸå¯¦ï¼ˆéš¨æ©Ÿï¼‰çš„è‡ªåŠ©é¤åƒ¹æ ¼ã€‚</p>
        </div>

        <!-- Controls -->
        <div class="bg-white p-6 rounded-2xl shadow-lg border-2 border-orange-200">
            <h2 class="font-bold text-lg mb-4 text-orange-800">1. å¤¾èœå€</h2>
            
            <div class="grid grid-cols-2 sm:grid-cols-4 gap-3 mb-6">
                <button onclick="addDish('meat')" class="dish-btn bg-red-100 hover:bg-red-200 text-red-800 py-3 rounded-xl flex flex-col items-center gap-1">
                    <span class="text-2xl">ğŸ—</span>
                    <span class="text-sm font-bold">å¤§è‚‰</span>
                </button>
                <button onclick="addDish('sub_meat')" class="dish-btn bg-pink-100 hover:bg-pink-200 text-pink-800 py-3 rounded-xl flex flex-col items-center gap-1">
                    <span class="text-2xl">ğŸ¥“</span>
                    <span class="text-sm font-bold">å°è‚‰</span>
                </button>
                <button onclick="addDish('veg')" class="dish-btn bg-green-100 hover:bg-green-200 text-green-800 py-3 rounded-xl flex flex-col items-center gap-1">
                    <span class="text-2xl">ğŸ¥¬</span>
                    <span class="text-sm font-bold">é’èœ</span>
                </button>
                <button onclick="addDish('egg')" class="dish-btn bg-yellow-100 hover:bg-yellow-200 text-yellow-800 py-3 rounded-xl flex flex-col items-center gap-1">
                    <span class="text-2xl">ğŸ¥š</span>
                    <span class="text-sm font-bold">è›‹/è±†è…</span>
                </button>
                <button onclick="addDish('rice')" class="dish-btn bg-gray-100 hover:bg-gray-200 text-gray-800 py-3 rounded-xl flex flex-col items-center gap-1 col-span-2 sm:col-span-4">
                    <span class="text-2xl">ğŸš</span>
                    <span class="text-sm font-bold">ç™½é£¯ (+10å…ƒ)</span>
                </button>
            </div>

            <div class="bg-gray-50 p-4 rounded-xl border border-dashed border-gray-300 min-h-[100px] mb-6">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-xs text-gray-400 font-bold uppercase tracking-wider">ä½ çš„é¤ç›¤</span>
                    <button onclick="clearPlate()" class="text-xs text-red-500 hover:text-red-700 underline">æ¸…ç©ºé‡å¤¾</button>
                </div>
                <div id="plate-items" class="flex flex-wrap gap-2 text-2xl">
                    <!-- Items go here -->
                    <span class="text-gray-400 text-sm italic py-2">ç›¤å­ç©ºç©ºçš„...</span>
                </div>
            </div>

            <h2 class="font-bold text-lg mb-4 text-orange-800">2. è®Šæ•¸è¨­å®š</h2>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">é˜¿å§¨ä»Šå¤©å¿ƒæƒ…</label>
                    <input type="range" id="mood" min="0" max="100" value="50" class="w-full accent-orange-600 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer">
                    <div class="flex justify-between text-xs text-gray-500 mt-1">
                        <span>å‰›åµå®Œæ¶ ğŸ˜¡</span>
                        <span>ä¸­æ¨‚é€ ğŸ¥°</span>
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">ä½ çš„ç©¿è‘—æ‰“æ‰®</label>
                    <select id="appearance" class="w-full p-2 rounded-lg border border-gray-300 bg-white">
                        <option value="normal">ä¸€èˆ¬è·¯äºº (Tæ¤çŸ­è¤²)</option>
                        <option value="rich">è¥¿è£ç­†æŒº (çœ‹èµ·ä¾†åƒç›¤å­)</option>
                        <option value="student">çª®å­¸ç”Ÿ (çœ‹èµ·ä¾†å¾ˆé¤“)</option>
                        <option value="familiar">ç†Ÿå®¢ (æ¯å¤©éƒ½ä¾†)</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">çµå¸³è©±è¡“</label>
                    <div class="flex gap-2">
                        <label class="flex-1 cursor-pointer">
                            <input type="radio" name="talk" value="none" class="peer hidden" checked>
                            <div class="p-2 text-center rounded-lg border peer-checked:bg-orange-100 peer-checked:border-orange-500 text-sm transition">
                                æ²‰é»˜ä¸èª
                            </div>
                        </label>
                        <label class="flex-1 cursor-pointer">
                            <input type="radio" name="talk" value="auntie" class="peer hidden">
                            <div class="p-2 text-center rounded-lg border peer-checked:bg-orange-100 peer-checked:border-orange-500 text-sm transition">
                                å«é˜¿å§¨
                            </div>
                        </label>
                        <label class="flex-1 cursor-pointer">
                            <input type="radio" name="talk" value="sister" class="peer hidden">
                            <div class="p-2 text-center rounded-lg border peer-checked:bg-orange-100 peer-checked:border-orange-500 text-sm transition">
                                å«å§Šå§Š
                            </div>
                        </label>
                    </div>
                </div>
            </div>

            <button onclick="calculatePrice()" class="w-full mt-8 bg-orange-600 hover:bg-orange-700 text-white font-bold py-4 rounded-xl shadow-lg transform transition active:scale-[0.98] text-lg">
                é˜¿å§¨ç®—éŒ¢ï¼ğŸ’°
            </button>
        </div>

        <!-- Result Modal (Hidden by default) -->
        <div id="result-overlay" class="fixed inset-0 bg-black/50 z-50 hidden flex items-center justify-center p-4 backdrop-blur-sm">
            <div class="bg-white rounded-2xl shadow-2xl max-w-sm w-full p-6 animate-[bounce_0.5s_ease-out]">
                <div class="text-center">
                    <div class="text-6xl mb-4">ğŸ‘€</div>
                    <h3 class="text-xl font-bold text-gray-800 mb-2">é˜¿å§¨ç„äº†ä¸€çœ¼...</h3>
                    <p id="comment" class="text-gray-600 mb-6 italic">"å¹´è¼•äººå¤šåƒé»..."</p>
                    
                    <div class="bg-orange-50 p-4 rounded-xl border border-orange-200 mb-6">
                        <span class="text-gray-500 text-sm">ç¸½é‡‘é¡</span>
                        <div class="text-5xl font-black text-orange-600">
                            $<span id="final-price">0</span>
                        </div>
                    </div>

                    <button onclick="closeResult()" class="w-full bg-gray-800 hover:bg-gray-900 text-white font-bold py-3 rounded-lg">
                        å¥½...è¬è¬é˜¿å§¨
                    </button>
                </div>
            </div>
        </div>

    </main>

    <!-- Footer -->
    <footer class="bg-gray-800 text-gray-400 py-6 text-center text-sm">
        <p>Created by AI Agent on 2026-02-01</p>
        <p class="mt-1">â€» æœ¬è¨ˆç®—æ©Ÿç´”å±¬å¨›æ¨‚ï¼Œå¯¦éš›åƒ¹æ ¼ä»¥é˜¿å§¨ç•¶ä¸‹å¿ƒæƒ…ç‚ºä¸»</p>
    </footer>

    <script>
        const plate = [];
        const prices = {
            meat: 40,      // Market price reference
            sub_meat: 25,
            veg: 15,
            egg: 15,
            rice: 10
        };
        const emojis = {
            meat: 'ğŸ—',
            sub_meat: 'ğŸ¥“',
            veg: 'ğŸ¥¬',
            egg: 'ğŸ¥š',
            rice: 'ğŸš'
        };

        function addDish(type) {
            plate.push(type);
            renderPlate();
        }

        function clearPlate() {
            plate.length = 0;
            renderPlate();
        }

        function renderPlate() {
            const container = document.getElementById('plate-items');
            if (plate.length === 0) {
                container.innerHTML = '<span class="text-gray-400 text-sm italic py-2">ç›¤å­ç©ºç©ºçš„...</span>';
                return;
            }
            container.innerHTML = plate.map(item => `<span>${emojis[item]}</span>`).join('');
        }

        function calculatePrice() {
            if (plate.length === 0) {
                alert("ä½ æ²’å¤¾èœæ˜¯è¦ç®—ç©ºæ°£å—ï¼Ÿ");
                return;
            }

            let baseTotal = 0;
            plate.forEach(item => baseTotal += prices[item]);

            // Factors
            const mood = parseInt(document.getElementById('mood').value); // 0-100 (Bad to Good)
            const appearance = document.getElementById('appearance').value;
            const talk = document.querySelector('input[name="talk"]:checked').value;

            let multiplier = 1.0;
            let comment = "";

            // Mood Impact (Bad mood = Higher price)
            // Mood 0 = 1.3x, Mood 50 = 1.0x, Mood 100 = 0.8x
            const moodFactor = 1.3 - (mood / 100) * 0.5;
            multiplier *= moodFactor;

            // Appearance Impact
            if (appearance === 'rich') {
                multiplier *= 1.2;
                comment = "é˜¿å§¨çœ‹ä½ ç©¿è¥¿è£ï¼Œæ‡‰è©²ä¸å·®é€™é»éŒ¢å§ï¼Ÿ";
            } else if (appearance === 'student') {
                multiplier *= 0.85;
                comment = "é‚„åœ¨é•·èº«é«”ï¼Œé˜¿å§¨ç®—ä½ ä¾¿å®œé»ã€‚";
            } else if (appearance === 'familiar') {
                multiplier *= 0.9; // Sometimes familiar gets discount, sometimes ripped off. Let's say discount.
                comment = "å¸¥å“¥åˆä¾†äº†å–”ï¼";
            } else {
                comment = "å—¯...ï¼ˆé˜¿å§¨è¿…é€Ÿå¿ƒç®—ä¸­ï¼‰";
            }

            // Talk Impact
            if (talk === 'sister') {
                if (mood < 30) {
                    multiplier *= 1.1; // Annoyed
                    comment = "å«å§Šå§Šä¹Ÿæ²’ç”¨ï¼Œæˆ‘å¾ˆå¿™ã€‚";
                } else {
                    multiplier *= 0.9; // Flattery works
                    comment = "å“å”·å˜´å·´çœŸç”œï¼Œå°‘ç®—ä½ 5å¡Šã€‚";
                }
            } else if (talk === 'auntie') {
                 // Neutral
            }

            // Random Chaos (The "Visual Estimation" Error) +/- 10%
            const chaos = 0.9 + Math.random() * 0.2;
            
            let finalPrice = Math.round(baseTotal * multiplier * chaos);

            // Round to nearest 5 or 0 usually
            finalPrice = Math.round(finalPrice / 5) * 5;

            // Override comments based on extreme price diff
            if (finalPrice > baseTotal * 1.5) {
                comment = "ï¼ˆé˜¿å§¨è¦ºå¾—ä½ çœ‹èµ·ä¾†åƒç›¤å­ï¼‰";
            } else if (finalPrice < baseTotal * 0.7) {
                comment = "ï¼ˆé˜¿å§¨ä»Šå¤©å¿ƒæƒ…ç‰¹å¥½ï¼Œéš¨ä¾¿ç®—ï¼‰";
            }

            showResult(finalPrice, comment);
        }

        function showResult(price, text) {
            document.getElementById('final-price').innerText = price;
            document.getElementById('comment').innerText = text;
            document.getElementById('result-overlay').classList.remove('hidden');
        }

        function closeResult() {
            document.getElementById('result-overlay').classList.add('hidden');
        }
    </script>
</body>
</html>