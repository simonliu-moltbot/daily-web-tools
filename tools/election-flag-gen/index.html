<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å°ç£é¸èˆ‰æ——å¹Ÿç”¢ç”Ÿå™¨ | Taiwan Election Flag Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #f3f4f6;
        }
        .flag-preview {
            box-shadow: 10px 10px 20px rgba(0,0,0,0.15);
            transition: transform 0.3s ease;
        }
        .flag-preview:hover {
            transform: scale(1.02);
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen flex flex-col items-center py-8 px-4">

    <!-- Header / Nav -->
    <div class="w-full max-w-4xl mb-8 flex justify-between items-center">
        <a href="../../index.html" class="text-blue-600 hover:text-blue-800 font-bold flex items-center gap-2 transition-colors">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd" />
            </svg>
            å›é¦–é  (Back to Home)
        </a>
        <h1 class="text-2xl font-bold text-gray-800 hidden md:block">ğŸ‡¹ğŸ‡¼ å°ç£é¸èˆ‰æ——å¹Ÿç”¢ç”Ÿå™¨</h1>
    </div>

    <!-- Main Content -->
    <div class="w-full max-w-5xl bg-white rounded-2xl shadow-xl overflow-hidden flex flex-col md:flex-row">
        
        <!-- Controls Section -->
        <div class="w-full md:w-1/3 p-6 bg-gray-50 border-r border-gray-200 overflow-y-auto max-h-[90vh]">
            <h2 class="text-xl font-bold mb-4 text-gray-700 flex items-center gap-2">
                <span>ğŸ¨</span> è¨­å®šåƒæ•¸
            </h2>

            <div class="space-y-4">
                <!-- Name -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">å€™é¸äººå§“å (Name)</label>
                    <input type="text" id="candidateName" value="ç‹å¤§æ˜" maxlength="4" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all" placeholder="æœ€å¤šå››å€‹å­—">
                </div>

                <!-- Number -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">è™Ÿæ¬¡ (Number)</label>
                    <div class="flex gap-2">
                        <button onclick="changeNumber(-1)" class="px-3 py-2 bg-gray-200 rounded hover:bg-gray-300">-</button>
                        <input type="number" id="candidateNumber" value="1" min="1" max="99" class="w-full text-center px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" readonly>
                        <button onclick="changeNumber(1)" class="px-3 py-2 bg-gray-200 rounded hover:bg-gray-300">+</button>
                    </div>
                </div>

                <!-- Slogan -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">ç«¶é¸å£è™Ÿ (Slogan)</label>
                    <input type="text" id="slogan" value="ç‚ºæ°‘æœå‹™" maxlength="10" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 mb-2" placeholder="ä¾‹å¦‚ï¼šæ”¹è®ŠæˆçœŸ">
                    <button onclick="randomSlogan()" class="w-full text-sm bg-indigo-100 text-indigo-700 py-1 rounded hover:bg-indigo-200 transition-colors">ğŸ² éš¨æ©Ÿç”¢ç”Ÿå£è™Ÿ</button>
                </div>

                <!-- Party Color -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">æ”¿é»¨è‰²ç³» (Party Color)</label>
                    <div class="grid grid-cols-5 gap-2">
                        <button onclick="setColor('blue')" class="h-8 w-full rounded bg-blue-600 ring-2 ring-transparent focus:ring-offset-2 focus:ring-blue-600 color-btn" data-color="blue"></button>
                        <button onclick="setColor('green')" class="h-8 w-full rounded bg-green-600 ring-2 ring-transparent focus:ring-offset-2 focus:ring-green-600 color-btn" data-color="green"></button>
                        <button onclick="setColor('white')" class="h-8 w-full rounded bg-gray-100 border border-gray-300 ring-2 ring-transparent focus:ring-offset-2 focus:ring-gray-400 color-btn" data-color="white"></button>
                        <button onclick="setColor('yellow')" class="h-8 w-full rounded bg-yellow-400 ring-2 ring-transparent focus:ring-offset-2 focus:ring-yellow-400 color-btn" data-color="yellow"></button>
                        <button onclick="setColor('pink')" class="h-8 w-full rounded bg-pink-400 ring-2 ring-transparent focus:ring-offset-2 focus:ring-pink-400 color-btn" data-color="pink"></button>
                    </div>
                </div>

                <!-- Photo Upload -->
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">ä¸Šå‚³ç…§ç‰‡ (Photo)</label>
                    <input type="file" id="photoUpload" accept="image/*" class="w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100">
                    <p class="text-xs text-gray-500 mt-1">*å»ºè­°ä½¿ç”¨å»èƒŒçš„äººåƒç…§ç‰‡ (Transparent PNG recommended)</p>
                </div>
                
                <!-- Action -->
                <div class="pt-4 border-t border-gray-200">
                    <button onclick="downloadFlag()" class="w-full bg-blue-600 text-white py-3 rounded-xl font-bold shadow-lg hover:bg-blue-700 transform hover:-translate-y-1 transition-all flex justify-center items-center gap-2">
                        <span>â¬‡ï¸</span> ä¸‹è¼‰æ——å¹Ÿ (Download)
                    </button>
                </div>
            </div>
        </div>

        <!-- Preview Section -->
        <div class="w-full md:w-2/3 p-8 bg-gray-200 flex flex-col justify-center items-center relative overflow-hidden">
            <!-- Background pattern for realism -->
            <div class="absolute inset-0 opacity-10 pointer-events-none" style="background-image: radial-gradient(#000 1px, transparent 1px); background-size: 20px 20px;"></div>
            
            <h3 class="text-gray-500 font-bold mb-4 z-10">é è¦½ (Preview)</h3>
            
            <!-- Canvas Container -->
            <div class="relative shadow-2xl">
                <!-- The Canvas -->
                <canvas id="flagCanvas" width="400" height="600" class="bg-white rounded-sm"></canvas>
                
                <!-- Pole decoration (CSS only) -->
                <div class="absolute top-0 bottom-0 -left-2 w-2 bg-gray-400 rounded-l"></div>
                <div class="absolute top-4 -left-3 w-4 h-4 bg-yellow-500 rounded-full border-2 border-white shadow-sm z-20"></div>
                <div class="absolute bottom-4 -left-3 w-4 h-4 bg-yellow-500 rounded-full border-2 border-white shadow-sm z-20"></div>
            </div>

            <p class="mt-4 text-sm text-gray-500 italic z-10">
                * å¯¦éš›ä¸‹è¼‰åœ–ç‰‡ä¸åŒ…å«æ——æ¡¿èˆ‡èƒŒæ™¯
            </p>
        </div>
    </div>

    <!-- Footer -->
    <footer class="mt-12 text-gray-500 text-sm">
        Created by AI Agent on 2026-02-11 | For entertainment only (åšå›ä¸€ç¬‘ï¼Œåˆ‡å‹¿ç•¶çœŸ)
    </footer>

    <script>
        // State
        const state = {
            name: "ç‹å¤§æ˜",
            number: 1,
            slogan: "ç‚ºæ°‘æœå‹™",
            color: "blue",
            photo: null // Image object
        };

        const colors = {
            blue: { bg: "#005cbf", text: "#ffffff", accent: "#ffcc00" },
            green: { bg: "#1b9a59", text: "#ffffff", accent: "#ffff00" },
            white: { bg: "#ffffff", text: "#333333", accent: "#ff0000" }, // TPP style-ish? Or neutral
            yellow: { bg: "#facc15", text: "#333333", accent: "#000000" }, // NPP style
            pink:   { bg: "#f472b6", text: "#ffffff", accent: "#ffff00" }
        };

        const canvas = document.getElementById('flagCanvas');
        const ctx = canvas.getContext('2d');

        // Init
        window.onload = () => {
            render();
            // Default random slogan
            randomSlogan();
        };

        // Listeners
        document.getElementById('candidateName').addEventListener('input', (e) => { state.name = e.target.value; render(); });
        document.getElementById('candidateNumber').addEventListener('change', (e) => { state.number = e.target.value; render(); });
        document.getElementById('slogan').addEventListener('input', (e) => { state.slogan = e.target.value; render(); });
        document.getElementById('photoUpload').addEventListener('change', handlePhotoUpload);

        function changeNumber(delta) {
            let n = parseInt(document.getElementById('candidateNumber').value) + delta;
            if (n < 1) n = 1;
            if (n > 99) n = 99;
            document.getElementById('candidateNumber').value = n;
            state.number = n;
            render();
        }

        function setColor(c) {
            state.color = c;
            // Update UI ring
            document.querySelectorAll('.color-btn').forEach(btn => {
                if(btn.dataset.color === c) {
                    btn.classList.add('ring-offset-2');
                } else {
                    btn.classList.remove('ring-offset-2');
                }
            });
            render();
        }

        function randomSlogan() {
            const slogans = [
                "æ”¹è®ŠæˆçœŸ", "è¶…è¶Šè—ç¶ ", "å…¨å¿ƒå…¨æ„", "ç¿»è½‰æœªä¾†", 
                "å®ˆè­·å®¶åœ’", "é’å¹´åƒæ”¿", "ç›¸ä¿¡å°ç£", "é¡§å¥½è‚šå­", 
                "å”¯ä¸€æ”¯æŒ", "åœ¨åœ°æ·±è€•", "ç†±æƒ…æœå‹™", "æ­£ç›´èª ä¿¡",
                "æ‰“ç ´æ²ˆé»˜", "å…‰æ¦®åŸå¸‚", "æœ€å¼·æˆ°åŠ›", "çµ•ä¸é€€ç¸®",
                "å°ç£åƒ¹å€¼", "æŠ—ä¸­ä¿å°", "å’Œå¹³ç¹æ¦®", "å…¨æ°‘åšä¸»"
            ];
            const s = slogans[Math.floor(Math.random() * slogans.length)];
            document.getElementById('slogan').value = s;
            state.slogan = s;
            render();
        }

        function handlePhotoUpload(e) {
            const file = e.target.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = (event) => {
                const img = new Image();
                img.onload = () => {
                    state.photo = img;
                    render();
                };
                img.src = event.target.result;
            };
            reader.readAsDataURL(file);
        }

        function render() {
            // Clear
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            const theme = colors[state.color];
            const w = canvas.width;
            const h = canvas.height;

            // Background
            ctx.fillStyle = theme.bg;
            ctx.fillRect(0, 0, w, h);

            // Diagonal Stripe (Dynamic)
            ctx.save();
            ctx.beginPath();
            ctx.moveTo(0, h * 0.6);
            ctx.lineTo(w, h * 0.4);
            ctx.lineTo(w, h);
            ctx.lineTo(0, h);
            ctx.closePath();
            // Slightly darker or lighter variant
            ctx.fillStyle = "rgba(0,0,0,0.1)"; 
            ctx.fill();
            ctx.restore();

            // Candidate Photo (Bottom Center usually)
            if (state.photo) {
                // Aspect ratio fit
                const pW = w * 0.8; 
                const pH = pW * (state.photo.height / state.photo.width);
                // Draw at bottom
                ctx.drawImage(state.photo, w/2 - pW/2, h - pH + 20, pW, pH); 
            } else {
                // Placeholder Silhouette
                ctx.fillStyle = "rgba(0,0,0,0.2)";
                ctx.beginPath();
                ctx.arc(w/2, h + 50, 180, 0, Math.PI * 2);
                ctx.fill();
                ctx.fillStyle = "rgba(255,255,255,0.3)";
                ctx.font = "bold 80px sans-serif";
                ctx.textAlign = "center";
                ctx.fillText("?", w/2, h - 50);
            }

            // Top Gradient / Header
            // Usually plain or gradient
            
            // Text: Number Circle
            // Circle
            const circleR = 50;
            const circleX = 80;
            const circleY = 80;
            
            ctx.beginPath();
            ctx.arc(circleX, circleY, circleR, 0, Math.PI * 2);
            ctx.fillStyle = "#ff0000"; // Stamp red usually
            ctx.fill();
            ctx.lineWidth = 4;
            ctx.strokeStyle = "#ffffff";
            ctx.stroke();

            // Number
            ctx.fillStyle = "#ffffff";
            ctx.font = "bold 60px 'Noto Sans TC'";
            ctx.textAlign = "center";
            ctx.textBaseline = "middle";
            ctx.fillText(state.number, circleX, circleY + 5);

            // Slogan (Vertical or Horizontal?)
            // Usually vertical on the right or horizontal top
            // Let's do horizontal top for readability
            ctx.fillStyle = theme.text; // "white" or "black"
            if (state.color === 'white' || state.color === 'yellow') ctx.fillStyle = "#d00"; // Red text on light bg pops
            
            ctx.font = "900 48px 'Noto Sans TC'";
            ctx.textAlign = "right";
            // Shadow
            ctx.shadowColor = "rgba(0,0,0,0.3)";
            ctx.shadowBlur = 4;
            ctx.shadowOffsetX = 2;
            ctx.shadowOffsetY = 2;
            
            // Draw Slogan (Split if too long?)
            const slogan = state.slogan || " ";
            ctx.fillText(slogan, w - 20, 80);

            // Name (Huge, Bottom or Middle)
            // Reset Shadow
            ctx.shadowColor = "transparent";
            
            // Name Box?
            // Let's put name vertically on the left if no photo, or horizontal bottom if photo?
            // Standard flag: Name is HUGE in the middle/bottom.
            
            // Let's do Vertical Text on the Right side (Traditional style)
            // Or Horizontal huge at bottom.
            // Let's do Horizontal Huge, slightly overlapping photo.
            
            ctx.font = "900 90px 'Noto Sans TC'";
            ctx.fillStyle = theme.text;
            if (state.color === 'white') ctx.fillStyle = "black";
            
            // Stroke for readability
            ctx.lineWidth = 6;
            ctx.strokeStyle = "white";
            if (state.color === 'white') ctx.strokeStyle = "white"; // white stroke on white bg is useless, use gray? No, usually white stroke on dark text.
            
            ctx.textAlign = "center";
            const nameY = h - 60;

            // Draw Name Stroke
            ctx.strokeText(state.name, w/2, nameY);
            // Draw Name Fill
            ctx.fillText(state.name, w/2, nameY);

            // "Vote for" text
            ctx.font = "bold 24px 'Noto Sans TC'";
            ctx.fillStyle = theme.text;
            if (state.color === 'white') ctx.fillStyle = "#555";
            ctx.lineWidth = 0;
            ctx.fillText("æ‡‡è«‹æ”¯æŒ", w/2, nameY - 80);

        }

        function downloadFlag() {
            const link = document.createElement('a');
            link.download = `election_flag_${state.name}.png`;
            link.href = canvas.toDataURL();
            link.click();
        }
    </script>
</body>
</html>
